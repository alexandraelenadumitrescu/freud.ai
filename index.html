<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Transylvania Blood Network</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: "Cinzel Decorative", serif;
        background-color: #0d0d0d;
        color: #f5f5f5;
        overflow-x: hidden;
        position: relative;
        background-image: url("https://images.unsplash.com/photo-1542848906-8809e6c38b25?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
      }

      /* Overlay to darken the background image */
      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        z-index: -1;
      }

      /* NEW: Initial Welcome Overlay Styles */
      #initial-welcome-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.95); /* Foarte întunecat */
        z-index: 100000; /* Extrem de mare pentru a fi deasupra la tot */
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        color: #f5f5f5;
        text-align: center;
        opacity: 1;
        transition: opacity 1s ease-in-out, visibility 1s ease-in-out;
        visibility: visible;
      }

      #initial-welcome-overlay.hidden {
        opacity: 0;
        visibility: hidden;
        pointer-events: none; /* Dezactivează interacțiunile când este ascuns */
      }

      #initial-welcome-overlay .welcome-image {
        max-width: 80%;
        max-height: 50vh; /* Ajustează după nevoie */
        border: 3px solid #e60000;
        box-shadow: 0 0 20px rgba(255, 0, 0, 0.7);
        border-radius: 8px;
        margin-bottom: 30px;
        object-fit: contain; /* Asigură că imaginea se potrivește bine */
      }

      #initial-welcome-overlay h2 {
        color: #e60000;
        font-size: 2.5em;
        margin-bottom: 15px;
        text-shadow: 0 0 10px rgba(255, 0, 0, 0.7);
      }

      #initial-welcome-overlay p {
        font-size: 1.2em;
        color: #ccc;
        margin-bottom: 40px;
        font-family: "Dancing Script", cursive; /* Un pic mai sinistru */
      }

      #initial-welcome-overlay button {
        background-color: #e60000;
        color: #f5f5f5;
        padding: 15px 30px;
        border: 2px solid #ff3333;
        border-radius: 5px;
        cursor: pointer;
        font-size: 1.3em;
        font-weight: bold;
        letter-spacing: 1px;
        transition: background-color 0.3s ease, transform 0.2s ease,
          box-shadow 0.3s ease;
      }

      #initial-welcome-overlay button:hover {
        background-color: #cc0000;
        transform: scale(1.05);
        box-shadow: 0 0 25px rgba(255, 0, 0, 0.9);
      }

      header {
        background-color: #1a1a1a;
        padding: 20px;
        text-align: center;
        font-size: 32px;
        color: #e60000;
        position: sticky;
        top: 0;
        z-index: 1000;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      /* Styles for logo */
      .header-logo {
        height: 80px;
        width: auto;
        margin-right: 15px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
      }

      nav {
        background-color: #1a1a1a;
        padding: 10px;
        text-align: center;
        position: sticky;
        top: 72px; /* Adjusted to be below the header */
        z-index: 999;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        display: flex; /* Make nav items flexible */
        justify-content: center; /* Center nav items */
        align-items: center;
      }

      nav a {
        color: #ccc;
        margin: 0 15px;
        text-decoration: none;
        font-size: 1.1em;
        transition: color 0.3s ease;
      }

      nav a:hover {
        color: #e60000;
      }

      /* New: Chat Icon in Nav */
      #nav-chat-icon {
        color: #f5f5f5; /* Culoarea icoanei de chat */
        font-size: 1.5em;
        margin-left: 20px; /* Spațiu față de celelalte link-uri */
        cursor: pointer;
        transition: color 0.3s ease;
      }

      #nav-chat-icon:hover {
        color: #e60000; /* Culoare la hover */
      }

      section {
        padding: 40px;
        max-width: 700px;
        margin: auto;
        line-height: 1.6;
        background-color: rgba(26, 26, 26, 0.8);
        border-radius: 8px;
        box-shadow: 0 0 15px rgba(230, 0, 0, 0.4);
        margin-top: 30px;
        position: relative;
        z-index: 10;
      }

      h2 {
        color: #e60000;
        text-align: center;
        margin-bottom: 25px;
        font-size: 2em;
      }

      input,
      select,
      button,
      textarea {
        padding: 12px;
        margin-top: 10px;
        width: calc(100% - 24px);
        background: #2a2a2a;
        color: #f5f5f5;
        border: 1px solid #e60000;
        border-radius: 5px;
        font-family: "Cinzel Decorative", serif;
        font-size: 1em;
        transition: background 0.3s ease, border-color 0.3s ease,
          box-shadow 0.3s ease;
      }

      input:focus,
      select:focus,
      textarea:focus {
        outline: none;
        border-color: #ff3333;
        box-shadow: 0 0 8px rgba(255, 51, 51, 0.6);
      }

      button {
        background-color: #e60000;
        cursor: pointer;
        width: 100%;
        margin-top: 20px;
        font-weight: bold;
        letter-spacing: 1px;
      }

      button:hover {
        background-color: #cc0000;
      }

      #letter {
        background-color: rgba(26, 26, 26, 0.8);
        padding: 20px;
        border: 1px dashed #e60000;
        margin-top: 20px;
        border-radius: 8px;
        box-shadow: inset 0 0 10px rgba(230, 0, 0, 0.3);
        white-space: pre-wrap;
      }

      /* New styles for handwriting effect */
      #output {
        font-family: "Dancing Script", cursive;
        font-size: 1.5em;
        color: #ccc;
        min-height: 200px;
      }

      /* Typing cursor effect */
      .typing-cursor::after {
        content: "|";
        display: inline-block;
        animation: blink-caret 0.75s infinite;
      }

      @keyframes blink-caret {
        from,
        to {
          border-color: transparent;
        }

        50% {
          border-color: #e60000;
        }
      }

      /* Styles for background bats */
      .bat {
        position: fixed;
        width: 60px;
        height: auto;
        pointer-events: none;
        opacity: 0.7;
        filter: drop-shadow(0 0 5px rgba(255, 0, 0, 0.3));
        z-index: 5;
      }

      @keyframes flyToRight {
        0% {
          transform: translateX(0vw) translateY(var(--startY)) scaleX(1);
          opacity: 0.7;
        }

        50% {
          transform: translateX(50vw) translateY(var(--midY)) scaleX(1);
        }

        100% {
          transform: translateX(100vw) translateY(var(--endY)) scaleX(1);
          opacity: 0.7;
        }
      }

      @keyframes flyToLeft {
        0% {
          transform: translateX(100vw) translateY(var(--startY)) scaleX(-1);
          opacity: 0.7;
        }

        50% {
          transform: translateX(50vw) translateY(var(--midY)) scaleX(-1);
        }

        100% {
          transform: translateX(0vw) translateY(var(--endY)) scaleX(-1);
          opacity: 0.7;
        }
      }

      /* Blood Drop Animation */
      .blood-drop {
        position: absolute;
        background-color: #e60000;
        border-radius: 50%;
        opacity: 0.8;
        pointer-events: none;
        animation: drip 1s ease-out forwards;
        filter: drop-shadow(0 0 5px rgba(255, 0, 0, 0.7));
      }

      @keyframes drip {
        0% {
          transform: translateY(0) scale(0.5);
          opacity: 0.8;
        }

        100% {
          transform: translateY(50px) scale(1);
          opacity: 0;
        }
      }

      /* Mist Effect on Scroll */
      .mist-overlay {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 0;
        background: linear-gradient(to top, rgba(230, 0, 0, 0.2), transparent);
        z-index: 20;
        pointer-events: none;
        transition: height 0.5s ease-out;
      }

      /* Mouse Glow */
      #mouse-glow {
        position: fixed;
        width: 50px;
        height: 50px;
        background-color: rgba(255, 0, 0, 0.1);
        border-radius: 50%;
        pointer-events: none;
        transform: translate(-50%, -50%);
        filter: blur(20px);
        z-index: 50;
        opacity: 0;
        transition: opacity 0.5s ease-out;
      }

      /* Sound Toggle Button */
      #sound-toggle-button {
        position: fixed;
        bottom: 20px;
        left: 20px;
        background-color: #f5f5f5;
        border: none;
        border-radius: 50%;
        width: 60px;
        height: 60px;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        box-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
        z-index: 200;
        transition: background-color 0.3s ease, transform 0.2s ease,
          box-shadow 0.3s ease;
      }

      #sound-toggle-button:hover {
        background-color: #e0e0e0;
        transform: scale(1.05);
        box-shadow: 0 0 20px rgba(255, 0, 0, 0.8);
      }

      /* Styles for sound button images */
      #sound-toggle-button img {
        width: 35px;
        height: 35px;
        display: block;
        object-fit: contain;
      }

      /* Initially hide the sound-on icon - controlled by JS display property */
      #sound-on-icon {
        display: none;
      }

      /* Styles for the "Catch Vlad" game */
      #bat-catcher-game {
        background-color: rgba(26, 26, 26, 0.8);
        border-radius: 8px;
        box-shadow: 0 0 15px rgba(230, 0, 0, 0.4);
        margin-top: 30px;
        padding: 20px;
        text-align: center;
      }

      #game-area {
        width: 100%;
        height: 300px;
        border: 2px dashed #e60000;
        margin: 20px auto;
        position: relative;
        overflow: hidden;
        background-color: rgba(0, 0, 0, 0.3);
        border-radius: 5px;
        cursor: crosshair;
      }

      /* Style for the game target image (now Vlad) */
      .game-bat {
        position: absolute;
        width: 80px;
        height: auto;
        cursor: pointer;
        transition: transform 0.1s ease-out;
        filter: drop-shadow(0 0 5px rgba(255, 0, 0, 0.5));
      }

      .game-bat:hover {
        transform: scale(1.1);
      }

      #game-info {
        display: flex;
        justify-content: space-around;
        margin-bottom: 15px;
        font-size: 1.2em;
        color: #f5f5f5;
      }

      #game-start-button {
        background-color: #008000;
        transition: background-color 0.3s ease;
      }

      #game-start-button:hover {
        background-color: #006400;
      }

      #game-start-button.disabled {
        background-color: #555;
        cursor: not-allowed;
      }

      /* Transition Overlay Styles (for game) */
      #transition-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: url("dracula.jpeg");
        background-size: cover;
        background-position: center;
        z-index: 10000;
        opacity: 0;
        visibility: hidden;
        transition: opacity 1.5s ease-in-out;
      }

      /* Contact Form specific styles */
      #contact-us form label {
        display: block;
        margin-top: 15px;
        margin-bottom: 5px;
        color: #e60000;
        font-weight: bold;
      }
      #contact-us textarea {
        min-height: 120px;
        resize: vertical;
      }
      #contact-us .success-message {
        margin-top: 20px;
        padding: 15px;
        background-color: rgba(0, 128, 0, 0.3);
        border: 1px solid #008000;
        border-radius: 5px;
        color: #f5f5f5;
        text-align: center;
        font-weight: bold;
        display: none;
      }

      /* Quiz Styles */
      #vampire-quiz {
        background-color: rgba(26, 26, 26, 0.8);
        border-radius: 8px;
        box-shadow: 0 0 15px rgba(230, 0, 0, 0.4);
        margin-top: 30px;
        padding: 20px;
      }

      .quiz-question {
        background-color: rgba(42, 42, 42, 0.7);
        border: 1px solid #550000;
        border-radius: 5px;
        padding: 15px;
        margin-bottom: 20px;
        text-align: left;
      }

      .quiz-question p {
        font-size: 1.1em;
        color: #f5f5f5;
        margin-bottom: 15px;
      }

      .quiz-options {
        display: grid;
        gap: 10px;
      }

      .quiz-options label {
        display: block;
        background: #2a2a2a;
        color: #ccc;
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #e60000;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .quiz-options label:hover {
        background-color: #3a0000;
        color: #fff;
      }

      .quiz-options input[type="radio"] {
        margin-right: 10px;
        accent-color: #e60000;
      }

      #submit-quiz {
        background-color: #e60000;
        cursor: pointer;
        width: 100%;
        margin-top: 20px;
        font-weight: bold;
        letter-spacing: 1px;
        padding: 12px;
        border: none;
        border-radius: 5px;
        color: #f5f5f5;
        font-family: "Cinzel Decorative", serif;
        font-size: 1em;
        transition: background-color 0.3s ease;
      }

      #submit-quiz:hover {
        background-color: #cc0000;
      }

      #quiz-result {
        margin-top: 20px;
        text-align: center;
        font-size: 1.3em;
        color: #e60000;
        font-family: "Dancing Script", cursive;
      }

      #result-description {
        margin-top: 10px;
        text-align: center;
        color: #ccc;
        font-style: italic;
      }

      .quiz-progress {
        color: #ccc;
        text-align: center;
        margin-bottom: 15px;
        font-style: italic;
      }

      .quiz-navigation {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
      }

      .quiz-navigation button {
        background-color: #550000;
        color: #f5f5f5;
        border: none;
        padding: 8px 15px;
        border-radius: 5px;
        cursor: pointer;
        font-family: "Cinzel Decorative", serif;
      }

      .quiz-navigation button:hover {
        background-color: #770000;
      }

      /* Countdown Timer Styles */
      #countdown-timer {
        background: linear-gradient(
          135deg,
          rgba(26, 26, 26, 0.95),
          rgba(42, 42, 42, 0.85)
        );
        border: 2px solid #e60000;
        border-radius: 15px;
        padding: 30px;
        text-align: center;
        box-shadow: 0 0 30px rgba(230, 0, 0, 0.6),
          inset 0 0 20px rgba(0, 0, 0, 0.8);
        position: relative;
        overflow: hidden;
      }

      #countdown-timer::before {
        content: "";
        position: absolute;
        top: -2px;
        left: -2px;
        right: -2px;
        bottom: -2px;
        background: linear-gradient(45deg, #e60000, #ff3333, #cc0000, #e60000);
        border-radius: 15px;
        z-index: -1;
        animation: borderPulse 3s ease-in-out infinite;
      }

      @keyframes borderPulse {
        0%,
        100% {
          opacity: 0.7;
        }
        50% {
          opacity: 1;
        }
      }

      .countdown-title {
        font-size: 1.8em;
        color: #e60000;
        margin-bottom: 20px;
        text-shadow: 0 0 10px rgba(230, 0, 0, 0.8);
        letter-spacing: 2px;
      }

      .timer-display {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin: 20px 0;
        flex-wrap: wrap;
      }

      .time-unit {
        background: rgba(0, 0, 0, 0.8);
        border: 1px solid #e60000;
        border-radius: 10px;
        padding: 15px 10px;
        min-width: 80px;
        position: relative;
        overflow: hidden;
      }

      .time-unit::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(230, 0, 0, 0.3),
          transparent
        );
        animation: shimmer 2s infinite;
      }

      @keyframes shimmer {
        0% {
          left: -100%;
        }
        100% {
          left: 100%;
        }
      }

      .time-number {
        font-size: 2.5em;
        color: #f5f5f5;
        font-weight: bold;
        text-shadow: 0 0 15px rgba(255, 0, 0, 0.7);
        display: block;
        line-height: 1;
        animation: numberGlow 2s ease-in-out infinite alternate;
      }

      @keyframes numberGlow {
        from {
          text-shadow: 0 0 15px rgba(255, 0, 0, 0.7);
        }
        to {
          text-shadow: 0 0 25px rgba(255, 0, 0, 1),
            0 0 35px rgba(255, 0, 0, 0.5);
        }
      }

      .time-label {
        font-size: 0.9em;
        color: #ccc;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-top: 5px;
      }

      .countdown-message {
        margin-bottom: 20px;
        font-size: 1.2em;
        color: #ccc;
        font-style: italic;
        min-height: 25px;
      }

      .countdown-finished {
        animation: finishedPulse 1s ease-in-out infinite;
        color: #ff3333 !important;
        font-weight: bold;
      }

      @keyframes finishedPulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }

      /* Demo button to test the countdown */
      .demo-button {
        background: linear-gradient(135deg, #e60000, #cc0000);
        border: none;
        border-radius: 8px;
        padding: 12px 24px;
        color: #f5f5f5;
        font-family: "Cinzel Decorative", serif;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-top: 20px;
        width: 100%;
      }

      .demo-button:hover {
        background: linear-gradient(135deg, #ff3333, #e60000);
        box-shadow: 0 0 15px rgba(230, 0, 0, 0.8);
        transform: translateY(-2px);
      }

      /* Responsive design */
      @media (max-width: 768px) {
        #initial-welcome-overlay .welcome-image {
          max-width: 90%;
          max-height: 40vh;
          margin-bottom: 20px;
        }
        #initial-welcome-overlay h2 {
          font-size: 1.8em;
        }
        #initial-welcome-overlay p {
          font-size: 1em;
          padding: 0 15px;
        }
        #initial-welcome-overlay button {
          font-size: 1em;
          padding: 12px 25px;
        }

        header {
          font-size: 24px;
          flex-direction: column;
        }

        .header-logo {
          height: 60px;
          margin-bottom: 10px;
          margin-right: 0;
        }

        section {
          padding: 20px;
          margin: 20px auto;
        }

        nav a {
          margin: 0 10px;
          font-size: 0.9em;
        }

        #sound-toggle-button {
          width: 50px;
          height: 50px;
          bottom: 10px;
          left: 10px;
        }

        #sound-toggle-button img {
          width: 28px;
          height: 28px;
        }

        #game-area {
          height: 200px;
        }

        #vampire-quiz {
          padding: 20px;
        }

        /* Countdown responsive styles */
        .timer-display {
          gap: 10px;
        }

        .time-unit {
          min-width: 70px;
          padding: 10px 5px;
        }

        .time-number {
          font-size: 2em;
        }

        .countdown-title {
          font-size: 1.5em;
        }

        /* Chat Window Responsive */
        #global-chat-window {
          width: 90%;
          right: 5%;
          bottom: 20px; /* Adjust if sound button interferes */
          height: 70vh; /* Make it taller on smaller screens */
          max-height: 500px;
        }

        #global-chat-window .chat-body {
          padding: 10px;
        }

        #global-chat-window #chat-input {
          padding: 8px;
        }

        #global-chat-window #send-message-button {
          padding: 8px 12px;
        }
      }

      /* NEW: Global Chat Window Styles */
      #global-chat-window {
        position: fixed;
        bottom: 25px; /* Adjust based on sound button and general layout */
        right: 25px;
        width: 380px;
        height: 500px;
        background-color: rgba(26, 26, 26, 0.95);
        border: 2px solid #e60000;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(255, 0, 0, 0.7);
        z-index: 10000; /* Higher than other elements, but below initial overlay */
        display: none; /* Hidden by default */
        flex-direction: column;
        overflow: hidden;
      }

      #global-chat-window.active {
        display: flex; /* Show when active */
      }

      .chat-header {
        background-color: #e60000;
        color: white;
        padding: 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 1.2em;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
      }

      .chat-header h3 {
        margin: 0;
        font-size: 1.1em;
      }

      .close-chat {
        cursor: pointer;
        font-size: 1.5em;
        font-weight: bold;
        transition: color 0.2s ease;
      }

      .close-chat:hover {
        color: #f0f0f0;
      }

      .chat-body {
        flex-grow: 1;
        padding: 15px;
        overflow-y: auto;
        background-color: #1a1a1a;
        border-bottom: 1px solid #550000;
        display: flex;
        flex-direction: column;
        gap: 10px; /* Space between messages */
      }

      .chat-message {
        background-color: #333;
        padding: 10px 15px;
        border-radius: 15px;
        max-width: 85%;
        word-wrap: break-word;
        font-size: 0.95em;
        line-height: 1.4;
        color: #f5f5f5;
        font-family: Arial, sans-serif; /* Simpler font for chat messages */
      }

      .chat-message.self {
        background-color: #0056b3; /* Your messages */
        align-self: flex-end; /* Align to right */
        border-bottom-right-radius: 5px;
      }

      .chat-message.other {
        background-color: #550000; /* Other users' messages */
        align-self: flex-start; /* Align to left */
        border-bottom-left-radius: 5px;
      }

      .chat-message strong {
        color: #e60000;
        margin-right: 5px;
      }

      .chat-message .blood-group {
        font-size: 0.8em;
        background-color: #ff3333;
        color: white;
        padding: 2px 6px;
        border-radius: 4px;
        margin-left: 5px;
        vertical-align: middle;
      }

      .chat-footer {
        display: flex;
        padding: 10px 15px;
        border-top: 1px solid #550000;
        background-color: #1a1a1a;
      }

      #chat-message-input {
        flex-grow: 1;
        padding: 10px;
        border: 1px solid #e60000;
        border-radius: 20px;
        background-color: #2a2a2a;
        color: #f5f5f5;
        margin-right: 10px;
        font-family: Arial, sans-serif;
        font-size: 0.9em;
      }

      #send-message-button {
        background-color: #28a745;
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 20px;
        cursor: pointer;
        font-family: "Cinzel Decorative", serif;
        font-size: 0.9em;
        transition: background-color 0.3s ease;
        width: auto; /* Override general button width */
        margin-top: 0; /* Override general button margin */
      }

      #send-message-button:hover {
        background-color: #218838;
      }

      /* Username input for chat */
      #chat-username-input-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.9);
        z-index: 100001; /* Higher than chat window */
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        color: white;
      }

      #chat-username-input-box {
        background-color: rgba(26, 26, 26, 0.95);
        border: 2px solid #e60000;
        border-radius: 10px;
        padding: 30px;
        text-align: center;
        box-shadow: 0 0 30px rgba(255, 0, 0, 0.8);
        width: 300px;
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      #chat-username-input-box label {
        font-size: 1.2em;
        color: #e60000;
        margin-bottom: 10px;
      }

      #chat-username-input-box input[type="text"] {
        width: calc(100% - 20px);
        padding: 10px;
        border-radius: 5px;
        border: 1px solid #e60000;
        background-color: #333;
        color: #f5f5f5;
      }

      #chat-username-input-box button {
        background-color: #e60000;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-family: "Cinzel Decorative", serif;
        font-size: 1em;
        width: 100%;
      }

      #chat-username-input-box button:hover {
        background-color: #cc0000;
      }
    </style>
</head>

<body>
    <div id="initial-welcome-overlay">
        <img src="dracula.jpeg" alt="Dracula Welcome" class="welcome-image" />
        <h2>Welcome to the Transylvania Blood Network.</h2>
        <p>Prepare to delve into the shadows...</p>
        <button id="enter-site-button">Enter at Your Own Risk</button>
    </div>

    <div id="bat-container"></div>
    <div id="mouse-glow"></div>
    <div class="mist-overlay" id="mist-overlay"></div>

    <div id="transition-overlay"></div>

    <audio id="bat-sound" loop>
        <source src="Toccata-and-fugue-in-d-minor.mp3" type="audio/mp3" />
        Your browser does not support the audio element.
    </audio>
    <audio id="drip-sound">
        <source src="water-drip-72357.mp3" type="audio/mp3" />
    </audio>
    <audio id="chime-sound">
        <source src="spooky-chimes-359877.mp3" type="audio/mp3" />
    </audio>
    <audio id="typing-sound">
        <source src="typewriter-100-88009.mp3" type="audio/mp3" />
        Your browser does not support the audio element.
    </audio>
    <audio id="wolf-howl-sound">
        <source src="wolf-howl.mp3" type="audio/mp3" />
        Your browser does not support the audio element.
    </audio>
    <audio id="evil-laugh-sound">
        <source src="evil-laugh-89423.mp3" type="audio/mp3" />
        Your browser does not support the audio element.
    </audio>

    <header>
        <img
            src="blood-donors-needed-halloween-dracula-volunteer-light-nikita-goel.jpg"
            alt="Transylvania Blood Network Logo"
            class="header-logo"
        />
        🩸 Transylvania Blood Network
    </header>

    <nav>
        <a href="#home">Home</a>
        <a href="#donate">Donate</a>
        <a href="#registered-donors">Donors</a>
        <a href="#facts-cravings">Secrets</a>
        <a href="#bat-catcher-game">Catch Vlad!</a>
        <a href="#vampire-quiz">Vampire Quiz</a>
        <a href="#countdown-section">Transformation</a>
        <a href="#letter">Your Letter</a>
        <a href="#contact-us">Contact</a>
        <a href="#about">About</a>
        <a href="#" id="nav-chat-icon" title="Open Chat">
            <i class="fas fa-comments"></i>
        </a>
    </nav>

    <section id="home">
        <h2>Welcome</h2>
        <p>
            Transylvania Blood Network connects generous donors with those who need
            them most. But more than blood, we deliver humanity, wrapped in a veil
            of ancient mystery. Every pulse, a story. Every drop, a destiny.
        </p>
    </section>

    <section id="donate">
        <h2>Become a Donor</h2>
        <label for="name">Your Name</label>
        <input type="text" id="name" placeholder="Enter your name..." />

        <label for="group">Blood Group</label>
        <select id="group">
            <option>A+</option>
            <option>A-</option>
            <option>B+</option>
            <option>B-</option>
            <option>AB+</option>
            <option>AB-</option>
            <option>O+</option>
            <option>O-</option>
        </select>

        <button onclick="submitDonor()">Generate Letter</button>
    </section>

    <section id="registered-donors">
        <h2>Registered Donors & Blood Inventory</h2>
        <div
            id="donor-list-container"
            style="
                max-height: 300px;
                overflow-y: auto;
                border: 1px solid #e60000;
                padding: 10px;
                border-radius: 5px;
                margin-bottom: 20px;
            "
        >
            <p id="no-donors-message" style="text-align: center; color: #ccc">
                No donors registered yet.
            </p>
            <ul id="donor-list" style="list-style-type: none; padding: 0"></ul>
        </div>
        <div
            id="blood-inventory"
            style="
                background-color: rgba(42, 42, 42, 0.8);
                padding: 15px;
                border-radius: 5px;
                border: 1px solid #e60000;
            "
        >
            <h3>Current Blood Inventory:</h3>
            <p id="inventory-summary" style="color: #f5f5f5">
                No blood data available.
            </p>
        </div>
        <button
            onclick="clearAllDonors()"
            style="margin-top: 20px; background-color: #550000"
        >
            Clear All Donors (Local)
        </button>
    </section>

    <section id="facts-cravings">
        <h2>Transylvanian Secrets & Cravings</h2>

        <h3>Random Vampire Fact:</h3>
        <button onclick="displayRandomVampireFact()">Reveal a Secret</button>
        <p
            id="vampire-fact-output"
            style="margin-top: 15px; font-style: italic; color: #ccc"
        >
            Click to uncover ancient truths.
        </p>

        <h3 style="margin-top: 30px">Blood Type Craving Compatibility:</h3>
        <label for="craving-group">Select Blood Type:</label>
        <select id="craving-group">
            <option>A+</option>
            <option>A-</option>
            <option>B+</option>
            <option>B-</option>
            <option>AB+</option>
            <option>AB-</option>
            <option>O+</option>
            <option>O-</option>
        </select>
        <button onclick="getBloodCraving()">Discover Cravings</button>
        <p
            id="craving-output"
            style="margin-top: 15px; font-style: italic; color: #ccc"
        >
            What will your blood crave tonight?
        </p>
    </section>

    <section id="bat-catcher-game">
        <h2>Catch Vlad!</h2>
        <div id="game-info">
            <div>Score: <span id="score">0</span></div>
            <div>Time: <span id="time-left">30</span>s</div>
        </div>
        <div id="game-area"></div>
        <button id="game-start-button">Start Game</button>
    </section>

    <section id="vampire-quiz">
        <h2>The Vampire Quiz</h2>
        <div id="quiz-container">
            <p class="quiz-progress">Question 1 of 5</p>
            <div class="quiz-question">
                <p>What is generally believed to repel vampires?</p>
                <div class="quiz-options">
                    <label>
                        <input type="radio" name="q1" value="a" /> Sunlight
                    </label>
                    <label>
                        <input type="radio" name="q1" value="b" /> Garlic
                    </label>
                    <label>
                        <input type="radio" name="q1" value="c" /> Holy Water
                    </label>
                    <label>
                        <input type="radio" name="q1" value="d" /> All of the above
                    </label>
                </div>
            </div>
            <div class="quiz-navigation">
                <button id="prev-question" style="display: none">Previous</button>
                <button id="next-question">Next</button>
            </div>
            <button id="submit-quiz" style="display: none">Submit Quiz</button>
        </div>
        <div id="quiz-result"></div>
        <p id="result-description"></p>
    </section>

    <section id="countdown-section">
        <div id="countdown-timer">
            <h2 class="countdown-title">Next Full Moon Transformation</h2>
            <p class="countdown-message" id="transformation-message">
                Prepare yourself... the night approaches.
            </p>
            <div class="timer-display">
                <div class="time-unit">
                    <span class="time-number" id="days">00</span>
                    <span class="time-label">Days</span>
                </div>
                <div class="time-unit">
                    <span class="time-number" id="hours">00</span>
                    <span class="time-label">Hours</span>
                </div>
                <div class="time-unit">
                    <span class="time-number" id="minutes">00</span>
                    <span class="time-label">Minutes</span>
                </div>
                <div class="time-unit">
                    <span class="time-number" id="seconds">00</span>
                    <span class="time-label">Seconds</span>
                </div>
            </div>
            <button class="demo-button" onclick="setCountdownDate()">Set New Transformation</button>
        </div>
    </section>
    <section id="letter">
        <h2>Your Personalized Letter</h2>
        <div id="output" class="typing-cursor"></div>
    </section>

    <section id="contact-us">
        <h2>Contact Us</h2>
        <form id="contact-form">
            <label for="contact-name">Name:</label>
            <input type="text" id="contact-name" name="name" required />

            <label for="contact-email">Email:</label>
            <input type="email" id="contact-email" name="email" required />

            <label for="contact-message">Message:</label>
            <textarea id="contact-message" name="message" required></textarea>

            <button type="submit">Send Message</button>
            <div class="success-message">
                Your message has been received by our shadowy network!
            </div>
        </form>
    </section>

    <section id="about">
        <h2>About Transylvania Blood Network</h2>
        <p>
            The Transylvania Blood Network is a mysterious organization operating
            from the ancient lands of Transylvania. We are dedicated to ensuring
            the flow of life's vital essence. Our history is as old as the mountains,
            and our purpose as enduring as the night. Join us, if you dare, in
            this timeless endeavor.
        </p>
    </section>

    <div id="global-chat-window">
        <div class="chat-header">
            <h3>Global Crypt Chat</h3>
            <span class="close-chat" id="close-chat-button">&times;</span>
        </div>
        <div class="chat-body" id="chat-messages">
            </div>
        <div class="chat-footer">
            <input
                type="text"
                id="chat-message-input"
                placeholder="Type your message..."
            />
            <button id="send-message-button">Send</button>
        </div>
    </div>

    <div id="chat-username-input-overlay">
        <div id="chat-username-input-box">
            <label for="chat-username">Enter your Crypt Name:</label>
            <input type="text" id="chat-username" placeholder="e.g., Shadow_Drifter" />
            <button id="set-username-button">Enter Chat</button>
        </div>
    </div>

    <button id="sound-toggle-button">
        <img id="sound-on-icon" src="sound-on.png" alt="Sound On" />
        <img id="sound-off-icon" src="sound-off.png" alt="Sound Off" />
    </button>

    <script>
        // Global variable for audio state
        let isSoundOn = false;
        const batSound = document.getElementById("bat-sound");
        const dripSound = document.getElementById("drip-sound");
        const chimeSound = document.getElementById("chime-sound");
        const typingSound = document.getElementById("typing-sound");
        const wolfHowlSound = document.getElementById("wolf-howl-sound");
        const evilLaughSound = document.getElementById("evil-laugh-sound");

        const soundOnIcon = document.getElementById("sound-on-icon");
        const soundOffIcon = document.getElementById("sound-off-icon");

        document
            .getElementById("enter-site-button")
            .addEventListener("click", function () {
                document.getElementById("initial-welcome-overlay").classList.add("hidden");
                // Start playing background music only after user interaction
                if (isSoundOn) {
                    batSound.play();
                }
            });

        document
            .getElementById("sound-toggle-button")
            .addEventListener("click", function () {
                isSoundOn = !isSoundOn;
                if (isSoundOn) {
                    batSound.play();
                    soundOnIcon.style.display = "block";
                    soundOffIcon.style.display = "none";
                } else {
                    batSound.pause();
                    soundOnIcon.style.display = "none";
                    soundOffIcon.style.display = "block";
                }
            });

        function playSound(soundElement) {
            if (isSoundOn) {
                soundElement.currentTime = 0; // Rewind to start
                soundElement.play();
            }
        }

        // Mouse Glow Effect
        const mouseGlow = document.getElementById("mouse-glow");
        document.addEventListener("mousemove", (e) => {
            mouseGlow.style.left = `${e.clientX}px`;
            mouseGlow.style.top = `${e.clientY}px`;
            mouseGlow.style.opacity = 1;
        });

        document.addEventListener("mouseleave", () => {
            mouseGlow.style.opacity = 0;
        });

        // Mist Effect on Scroll
        const mistOverlay = document.getElementById("mist-overlay");
        window.addEventListener("scroll", () => {
            const scrollHeight = document.documentElement.scrollHeight - window.innerHeight;
            const scrolled = window.scrollY;
            const scrollProgress = scrolled / scrollHeight;
            mistOverlay.style.height = `${scrollProgress * 100}vh`; // Increase height based on scroll
        });

        // Background Bat Animation
        const batContainer = document.getElementById("bat-container");
        const batImageSrc = "bat-silhouette.png"; // Replace with your bat image path

        function createBat() {
            const bat = document.createElement("img");
            bat.src = batImageSrc;
            bat.classList.add("bat");
            batContainer.appendChild(bat);

            const startY = Math.random() * (window.innerHeight * 0.8);
            const midY = Math.random() * (window.innerHeight * 0.8);
            const endY = Math.random() * (window.innerHeight * 0.8);

            const duration = 10 + Math.random() * 10; // 10-20 seconds
            const direction = Math.random() > 0.5 ? "left" : "right";

            bat.style.setProperty("--startY", `${startY}px`);
            bat.style.setProperty("--midY", `${midY}px`);
            bat.style.setProperty("--endY", `${endY}px`);
            bat.style.animation = `flyTo${direction === "right" ? "Right" : "Left"
                } ${duration}s linear infinite`;

            if (direction === "left") {
                bat.style.left = "100vw"; // Start from right
            } else {
                bat.style.left = "-60px"; // Start from left
            }

            bat.style.top = `${startY}px`;

            // Remove bat after one animation cycle to prevent accumulation
            bat.addEventListener("animationiteration", () => {
                bat.remove();
            });
        }

        setInterval(createBat, 3000); // Create a new bat every 3 seconds

        // Blood Drip on Click
        document.addEventListener("click", (e) => {
            const drop = document.createElement("div");
            drop.classList.add("blood-drop");
            document.body.appendChild(drop);

            const size = 10 + Math.random() * 10; // 10-20px
            drop.style.width = `${size}px`;
            drop.style.height = `${size}px`;
            drop.style.left = `${e.clientX}px`;
            drop.style.top = `${e.clientY}px`;

            playSound(dripSound); // Play drip sound

            drop.addEventListener("animationend", () => {
                drop.remove();
            });
        });

        const donors = JSON.parse(localStorage.getItem("donors")) || [];
        const bloodInventory = JSON.parse(localStorage.getItem("bloodInventory")) || {};

        function updateDonorList() {
            const donorList = document.getElementById("donor-list");
            const noDonorsMessage = document.getElementById("no-donors-message");
            donorList.innerHTML = ""; // Clear existing list

            if (donors.length === 0) {
                noDonorsMessage.style.display = "block";
            } else {
                noDonorsMessage.style.display = "none";
                donors.forEach((donor) => {
                    const listItem = document.createElement("li");
                    listItem.style.cssText = `
                background-color: rgba(42, 42, 42, 0.7);
                border: 1px solid #550000;
                border-radius: 5px;
                padding: 10px;
                margin-bottom: 8px;
                display: flex;
                justify-content: space-between;
                align-items: center;
                box-shadow: 0 0 8px rgba(255, 0, 0, 0.2);
            `;
                    listItem.innerHTML = `
                <span>${donor.name} (<span style="color: #e60000; font-weight: bold;">${donor.group}</span>)</span>
                <button
                    onclick="removeDonor('${donor.id}')"
                    style="
                        background-color: #8b0000;
                        color: white;
                        border: none;
                        padding: 5px 10px;
                        border-radius: 3px;
                        cursor: pointer;
                        font-size: 0.8em;
                        width: auto;
                        margin-top: 0;
                    "
                >
                    Remove
                </button>
            `;
                    donorList.appendChild(listItem);
                });
            }
        }

        function updateBloodInventory() {
            const inventorySummary = document.getElementById("inventory-summary");
            let summaryHtml = "";
            let hasBlood = false;

            for (const group in bloodInventory) {
                if (bloodInventory[group] > 0) {
                    summaryHtml += `<p>${group}: ${bloodInventory[group]} units</p>`;
                    hasBlood = true;
                }
            }

            if (!hasBlood) {
                inventorySummary.textContent = "No blood data available.";
            } else {
                inventorySummary.innerHTML = summaryHtml;
            }
        }

        function submitDonor() {
            const name = document.getElementById("name").value.trim();
            const group = document.getElementById("group").value;

            if (name) {
                const newDonor = { id: Date.now().toString(), name, group };
                donors.push(newDonor);
                localStorage.setItem("donors", JSON.stringify(donors));

                // Update blood inventory
                bloodInventory[group] = (bloodInventory[group] || 0) + 1;
                localStorage.setItem("bloodInventory", JSON.stringify(bloodInventory));

                updateDonorList();
                updateBloodInventory();
                generatePersonalizedLetter(name, group);
                document.getElementById("name").value = ""; // Clear input
            } else {
                alert("Please enter your name!");
            }
        }

        function removeDonor(id) {
            const donorIndex = donors.findIndex((donor) => donor.id === id);
            if (donorIndex > -1) {
                const removedDonor = donors.splice(donorIndex, 1)[0];
                localStorage.setItem("donors", JSON.stringify(donors));

                // Decrease blood inventory
                if (bloodInventory[removedDonor.group]) {
                    bloodInventory[removedDonor.group]--;
                    if (bloodInventory[removedDonor.group] <= 0) {
                        delete bloodInventory[removedDonor.group]; // Remove if 0 or less
                    }
                    localStorage.setItem("bloodInventory", JSON.stringify(bloodInventory));
                }

                updateDonorList();
                updateBloodInventory();
            }
        }

        function clearAllDonors() {
            if (confirm("Are you sure you want to clear all registered donors and blood inventory? This cannot be undone.")) {
                donors.length = 0; // Clear the array
                for (const group in bloodInventory) {
                    delete bloodInventory[group]; // Clear the object
                }
                localStorage.removeItem("donors");
                localStorage.removeItem("bloodInventory");
                updateDonorList();
                updateBloodInventory();
                alert("All donors and inventory cleared!");
            }
        }

        function generatePersonalizedLetter(name, group) {
            const outputDiv = document.getElementById("output");
            outputDiv.textContent = ""; // Clear previous text
            outputDiv.classList.add("typing-cursor");

            const letterContent = `My Dearest ${name}, kindred spirit,

Your generous spirit, pure and vital ${group} blood, flows into the very veins of Transylvania. With each beat of your noble heart, you strengthen our ancient network, weaving your destiny with ours. The moon watches, the shadows whisper, and a profound gratitude echoes through the ancestral halls.

Know that your contribution is not merely a gift, but a pact. A pact signed in scarlet, binding you to the timeless ebb and flow of this land. We shall remember your essence.

Until the next crimson dawn,

Count Dracula
Master of the Transylvania Blood Network`;

            let i = 0;
            const speed = 50; // typing speed in milliseconds

            function typeWriter() {
                if (i < letterContent.length) {
                    outputDiv.textContent += letterContent.charAt(i);
                    i++;
                    playSound(typingSound);
                    setTimeout(typeWriter, speed);
                } else {
                    outputDiv.classList.remove("typing-cursor"); // Remove cursor after typing
                }
            }
            typeWriter();
        }

        // Initialize lists on load
        updateDonorList();
        updateBloodInventory();

        // Vampire Facts and Cravings
        const vampireFacts = [
            "The first known literary mention of vampires appeared in the early 18th century.",
            "Garlic is believed to repel vampires due to its strong odor, which interferes with their heightened senses.",
            "Vampires are often depicted as unable to cross running water, a symbol of purity and life.",
            "The word 'vampire' likely comes from the Slavic word 'vampir'.",
            "Vlad the Impaler, a 15th-century Wallachian prince, is often associated with the Dracula legend.",
            "Some folklore suggests vampires can be killed by a stake through the heart, specifically of wood like hawthorn or ash.",
            "In certain legends, vampires are compelled to count seeds if spilled, making them vulnerable.",
            "Mirrors supposedly don't reflect vampires, symbolizing their soulless nature.",
            "Bram Stoker's 'Dracula' (1897) popularized many modern vampire tropes.",
            "The bat is a common animal associated with vampires, linking them to night and flight.",
        ];

        const bloodCravings = {
            "A+": "A deep, earthy cabernet, robust and full-bodied.",
            "A-": "A crisp, chilled pinot grigio, delicate and sharp.",
            "B+": "A rich, velvety merlot with notes of dark berries.",
            "B-": "A light-bodied, sparkling rosé, effervescent and sweet.",
            "AB+": "A complex, aged port wine, a blend of many essences.",
            "AB-": "A rare, ice-cold vodka, clean and potent.",
            "O+": "A hearty, rustic red ale, satisfying and strong.",
            "O-": "A pure, distilled absinthe, ethereal and captivating.",
        };

        function displayRandomVampireFact() {
            const factOutput = document.getElementById("vampire-fact-output");
            const randomIndex = Math.floor(Math.random() * vampireFacts.length);
            factOutput.textContent = vampireFacts[randomIndex];
            playSound(chimeSound); // Play a mysterious chime
        }

        function getBloodCraving() {
            const selectedGroup = document.getElementById("craving-group").value;
            const cravingOutput = document.getElementById("craving-output");
            cravingOutput.textContent = bloodCravings[selectedGroup] || "No specific craving known for this type.";
            playSound(wolfHowlSound); // Play wolf howl for cravings
        }

        // Catch Vlad! Game
        const gameArea = document.getElementById("game-area");
        const scoreDisplay = document.getElementById("score");
        const timeLeftDisplay = document.getElementById("time-left");
        const gameStartButton = document.getElementById("game-start-button");
        let score = 0;
        let timeLeft = 30;
        let gameTimer;
        let vladTimer;
        let isGameRunning = false;

        const vladImageSrc = "vlad-the-impaler.png"; // Replace with your Vlad image path

        function createVlad() {
            if (!isGameRunning) return;

            const vlad = document.createElement("img");
            vlad.src = vladImageSrc;
            vlad.classList.add("game-bat"); // Reusing bat style
            gameArea.appendChild(vlad);

            const gameAreaRect = gameArea.getBoundingClientRect();
            const maxX = gameAreaRect.width - 80; // Vlad width
            const maxY = gameAreaRect.height - 80; // Vlad height

            const randomX = Math.random() * maxX;
            const randomY = Math.random() * maxY;

            vlad.style.left = `${randomX}px`;
            vlad.style.top = `${randomY}px`;

            vlad.onclick = () => {
                if (isGameRunning) {
                    score++;
                    scoreDisplay.textContent = score;
                    vlad.remove();
                    playSound(dripSound); // Sound on hit
                    createVlad(); // Immediately create a new one
                }
            };

            // Remove Vlad after a short time if not clicked
            setTimeout(() => {
                if (vlad.parentNode === gameArea) {
                    vlad.remove();
                    if (isGameRunning) {
                        createVlad(); // Create a new one if missed
                    }
                }
            }, 1000 + Math.random() * 500); // Vlad stays for 1-1.5 seconds
        }

        function startGame() {
            if (isGameRunning) return; // Prevent multiple starts
            isGameRunning = true;
            score = 0;
            timeLeft = 30;
            scoreDisplay.textContent = score;
            timeLeftDisplay.textContent = timeLeft;
            gameStartButton.textContent = "Game In Progress...";
            gameStartButton.classList.add("disabled");

            gameArea.innerHTML = ""; // Clear previous Vlads

            gameTimer = setInterval(() => {
                timeLeft--;
                timeLeftDisplay.textContent = timeLeft;
                if (timeLeft <= 0) {
                    endGame();
                }
            }, 1000);

            vladTimer = setInterval(createVlad, 1500); // Vlad appears every 1.5 seconds
            createVlad(); // Create first Vlad immediately
        }

        function endGame() {
            isGameRunning = false;
            clearInterval(gameTimer);
            clearInterval(vladTimer);
            gameStartButton.textContent = "Start Game";
            gameStartButton.classList.remove("disabled");
            gameArea.innerHTML = `<p style="color: #e60000; font-size: 1.5em;">Time's Up! You caught ${score} Vlads.</p>`;
            playSound(evilLaughSound); // Play evil laugh at end of game
        }

        gameStartButton.addEventListener("click", startGame);

        // Vampire Quiz
        const quizData = [
            {
                question: "What is generally believed to repel vampires?",
                options: ["Sunlight", "Garlic", "Holy Water", "All of the above"],
                answer: "All of the above",
            },
            {
                question: "Which author wrote 'Dracula'?",
                options: ["Mary Shelley", "Bram Stoker", "Edgar Allan Poe", "Anne Rice"],
                answer: "Bram Stoker",
            },
            {
                question: "Vampires are often depicted as being unable to see their reflection in:",
                options: ["Puddles", "Mirrors", "Water", "Shiny metal"],
                answer: "Mirrors",
            },
            {
                question: "According to some folklore, what must a vampire do if a bag of seeds is spilled?",
                options: ["Eat them all", "Count every single one", "Ignore them", "Plant them"],
                answer: "Count every single one",
            },
            {
                question: "What type of wood is traditionally used for a vampire-killing stake?",
                options: ["Oak", "Pine", "Hawthorn or Ash", "Maple"],
                answer: "Hawthorn or Ash",
            },
        ];

        let currentQuestionIndex = 0;
        let userAnswers = new Array(quizData.length).fill(null); // To store answers
        let scoreQuiz = 0;

        const quizContainer = document.getElementById("quiz-container");
        const quizResultDiv = document.getElementById("quiz-result");
        const resultDescriptionDiv = document.getElementById("result-description");
        const submitQuizButton = document.getElementById("submit-quiz");
        const prevQuestionButton = document.getElementById("prev-question");
        const nextQuestionButton = document.getElementById("next-question");
        const quizProgressSpan = quizContainer.querySelector(".quiz-progress");

        function loadQuestion(index) {
            const q = quizData[index];
            quizContainer.innerHTML = `
                <p class="quiz-progress">Question ${index + 1} of ${quizData.length}</p>
                <div class="quiz-question">
                    <p>${q.question}</p>
                    <div class="quiz-options">
                        ${q.options
                    .map(
                        (option, i) => `
                            <label>
                                <input type="radio" name="current_q" value="${option}" ${userAnswers[index] === option ? "checked" : ""
                        } /> ${option}
                            </label>
                        `
                    )
                    .join("")}
                    </div>
                </div>
                <div class="quiz-navigation">
                    <button id="prev-question" style="${index === 0 ? "display: none;" : ""
                }">Previous</button>
                    <button id="next-question" style="${index === quizData.length - 1 ? "display: none;" : ""
                }">Next</button>
                </div>
                <button id="submit-quiz" style="${index === quizData.length - 1 ? "display: block;" : "display: none;"
                }">Submit Quiz</button>
            `;

            // Re-attach event listeners after recreating elements
            document.getElementById("prev-question").addEventListener("click", () => {
                saveAnswer();
                currentQuestionIndex--;
                loadQuestion(currentQuestionIndex);
            });
            document.getElementById("next-question").addEventListener("click", () => {
                saveAnswer();
                currentQuestionIndex++;
                loadQuestion(currentQuestionIndex);
            });
            if (index === quizData.length - 1) {
                document.getElementById("submit-quiz").addEventListener("click", submitQuiz);
            }
        }

        function saveAnswer() {
            const selectedOption = document.querySelector(
                'input[name="current_q"]:checked'
            );
            if (selectedOption) {
                userAnswers[currentQuestionIndex] = selectedOption.value;
            } else {
                userAnswers[currentQuestionIndex] = null; // Ensure null if no selection
            }
        }

        function submitQuiz() {
            saveAnswer(); // Save answer for the last question
            scoreQuiz = 0;
            for (let i = 0; i < quizData.length; i++) {
                if (userAnswers[i] === quizData[i].answer) {
                    scoreQuiz++;
                }
            }

            quizResultDiv.textContent = `You scored ${scoreQuiz} out of ${quizData.length}!`;
            if (scoreQuiz === quizData.length) {
                resultDescriptionDiv.textContent =
                    "A true connoisseur of the arcane! You are one of us.";
            } else if (scoreQuiz >= quizData.length / 2) {
                resultDescriptionDiv.textContent =
                    "You possess some forbidden knowledge. The night awaits your further studies.";
            } else {
                resultDescriptionDiv.textContent =
                    "Your understanding of the shadows is… limited. Perhaps more research is needed.";
            }
            playSound(chimeSound); // Play chime for quiz result
        }

        loadQuestion(currentQuestionIndex); // Load the first question on page load

        // Contact Form Submission
        document.getElementById("contact-form").addEventListener("submit", function (event) {
            event.preventDefault(); // Prevent default form submission

            const name = document.getElementById("contact-name").value;
            const email = document.getElementById("contact-email").value;
            const message = document.getElementById("contact-message").value;

            // In a real application, you would send this data to a server
            console.log("Contact Form Submitted:");
            console.log("Name:", name);
            console.log("Email:", email);
            console.log("Message:", message);

            const successMessage = this.querySelector(".success-message");
            successMessage.style.display = "block";
            playSound(chimeSound); // Play chime on success

            // Optionally clear the form
            this.reset();

            // Hide the success message after a few seconds
            setTimeout(() => {
                successMessage.style.display = "none";
            }, 5000);
        });

        // Countdown Timer Logic
        const daysSpan = document.getElementById('days');
        const hoursSpan = document.getElementById('hours');
        const minutesSpan = document.getElementById('minutes');
        const secondsSpan = document.getElementById('seconds');
        const transformationMessage = document.getElementById('transformation-message');

        let countdownInterval;
        let targetDate = localStorage.getItem('countdownTargetDate') ? new Date(localStorage.getItem('countdownTargetDate')) : null;

        function updateCountdown() {
            const now = new Date().getTime();
            if (!targetDate || now > targetDate.getTime()) {
                transformationMessage.textContent = "The transformation has passed. A new cycle will begin soon...";
                transformationMessage.classList.add('countdown-finished');
                daysSpan.textContent = '00';
                hoursSpan.textContent = '00';
                minutesSpan.textContent = '00';
                secondsSpan.textContent = '00';
                clearInterval(countdownInterval);
                return;
            }

            const distance = targetDate.getTime() - now;

            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            daysSpan.textContent = String(days).padStart(2, '0');
            hoursSpan.textContent = String(hours).padStart(2, '0');
            minutesSpan.textContent = String(minutes).padStart(2, '0');
            secondsSpan.textContent = String(seconds).padStart(2, '0');

            transformationMessage.textContent = "Prepare yourself... the night approaches.";
            transformationMessage.classList.remove('countdown-finished');

            if (distance < 0) {
                transformationMessage.textContent = "The transformation is complete! Embrace your new form.";
                transformationMessage.classList.add('countdown-finished');
                clearInterval(countdownInterval);
            }
        }

        function setCountdownDate() {
            const daysToAdd = parseInt(prompt("Enter the number of days until the next transformation:", "30"));
            if (!isNaN(daysToAdd) && daysToAdd > 0) {
                targetDate = new Date();
                targetDate.setDate(targetDate.getDate() + daysToAdd);
                targetDate.setHours(23, 59, 59, 999); // Set to end of the day

                localStorage.setItem('countdownTargetDate', targetDate.toISOString());
                if (countdownInterval) {
                    clearInterval(countdownInterval);
                }
                countdownInterval = setInterval(updateCountdown, 1000);
                updateCountdown(); // Call immediately to update display
            } else {
                alert("Please enter a valid positive number of days.");
            }
        }

        // Initialize countdown on page load
        if (targetDate) {
            countdownInterval = setInterval(updateCountdown, 1000);
            updateCountdown();
        } else {
            // If no date is set, show a prompt or default message
            transformationMessage.textContent = "Click 'Set New Transformation' to begin the countdown.";
            daysSpan.textContent = '00';
            hoursSpan.textContent = '00';
            minutesSpan.textContent = '00';
            secondsSpan.textContent = '00';
        }


        // Global Chat Functionality
        const navChatIcon = document.getElementById('nav-chat-icon');
        const globalChatWindow = document.getElementById('global-chat-window');
        const closeChatButton = document.getElementById('close-chat-button');
        const chatMessagesDiv = document.getElementById('chat-messages');
        const chatMessageInput = document.getElementById('chat-message-input');
        const sendMessageButton = document.getElementById('send-message-button');
        const chatUsernameInputOverlay = document.getElementById('chat-username-input-overlay');
        const chatUsernameInput = document.getElementById('chat-username');
        const setUsernameButton = document.getElementById('set-username-button');

        let chatUsername = localStorage.getItem('chatUsername'); // Try to load username

        // Function to append messages to the chat window
        function appendMessage(username, message, bloodGroup, isSelf = false) {
            const messageElement = document.createElement('div');
            messageElement.classList.add('chat-message');
            if (isSelf) {
                messageElement.classList.add('self');
            } else {
                messageElement.classList.add('other');
            }
            messageElement.innerHTML = `<strong>${username}</strong> <span class="blood-group">${bloodGroup}</span>: ${message}`;
            chatMessagesDiv.appendChild(messageElement);
            chatMessagesDiv.scrollTop = chatMessagesDiv.scrollHeight; // Scroll to bottom
        }

        // Simulate receiving messages from other users
        function simulateIncomingMessage() {
            const sampleMessages = [
                "The night is truly enchanting tonight.",
                "Anyone else feeling a peculiar thirst?",
                "Heard whispers of a new blood moon rising...",
                "Beware the dawn!",
                "Has anyone seen Vlad lately?",
                "The shadows grow longer with each passing moment."
            ];
            const sampleUsernames = ["Nocturne", "Crimson_Specter", "Shadow_Dancer", "Blood_Mistress", "Countess_Liz", "Grave_Walker"];
            const sampleBloodGroups = ["O+", "A-", "B+", "AB-", "A+", "O-"];

            const randomMessage = sampleMessages[Math.floor(Math.random() * sampleMessages.length)];
            const randomUser = sampleUsernames[Math.floor(Math.random() * sampleUsernames.length)];
            const randomBloodGroup = sampleBloodGroups[Math.floor(Math.random() * sampleBloodGroups.length)];

            // Simulate typing delay
            setTimeout(() => {
                appendMessage(randomUser, randomMessage, randomBloodGroup);
            }, 1000 + Math.random() * 2000);
        }

        // Send message function
        function sendMessage() {
            const message = chatMessageInput.value.trim();
            if (message && chatUsername) {
                const userBloodGroup = document.getElementById('group').value; // Get the user's selected blood group from donor form
                appendMessage(chatUsername, message, userBloodGroup || 'Unknown', true); // Display message as self
                chatMessageInput.value = ''; // Clear input

                // Simulate a response after sending your message
                simulateIncomingMessage();
            } else if (!chatUsername) {
                alert("Please set your Crypt Name before sending messages!");
                chatUsernameInputOverlay.style.display = 'flex'; // Show username input
            }
        }

        // Event listeners for chat
        navChatIcon.addEventListener('click', () => {
            if (chatUsername) {
                globalChatWindow.classList.add('active');
                chatMessagesDiv.scrollTop = chatMessagesDiv.scrollHeight; // Scroll to bottom on open
                chatMessageInput.focus();
            } else {
                chatUsernameInputOverlay.style.display = 'flex';
            }
        });

        closeChatButton.addEventListener('click', () => {
            globalChatWindow.classList.remove('active');
        });

        sendMessageButton.addEventListener('click', sendMessage);
        chatMessageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Username input handling
        setUsernameButton.addEventListener('click', () => {
            const enteredUsername = chatUsernameInput.value.trim();
            if (enteredUsername) {
                chatUsername = enteredUsername;
                localStorage.setItem('chatUsername', chatUsername);
                chatUsernameInputOverlay.style.display = 'none';
                globalChatWindow.classList.add('active'); // Open chat after setting username
                chatMessagesDiv.scrollTop = chatMessagesDiv.scrollHeight; // Scroll to bottom
                chatMessageInput.focus();
            } else {
                alert("Please enter a valid Crypt Name!");
            }
        });

        // Hide username input if already set on load
        if (chatUsername) {
            chatUsernameInputOverlay.style.display = 'none';
        }

        // Initialize with a welcome message in chat (optional)
        if (chatUsername) {
            appendMessage("System", `Welcome, ${chatUsername}! The shadows are listening...`, "SYS", false);
        }

    </script>
</body>
</html>
